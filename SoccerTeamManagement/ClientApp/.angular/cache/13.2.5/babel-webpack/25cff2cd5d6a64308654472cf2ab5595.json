{"ast":null,"code":"import { HttpClient, HttpParams } from '@angular/common/http';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { MatPaginator, PageEvent } from '@angular/material/paginator';\nimport { MatSort } from '@angular/material/sort';\nimport { Subject } from 'rxjs';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { PlayerService } from '../../../../services/player.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../../../../services/player.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/input\";\nimport * as i7 from \"@angular/material/table\";\nimport * as i8 from \"@angular/material/sort\";\nimport * as i9 from \"@angular/material/paginator\";\n\nfunction PlayerListComponent_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\")(1, \"em\");\n    i0.ɵɵtext(2, \"Loading...\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c0 = function () {\n  return [\"/player\"];\n};\n\nfunction PlayerListComponent_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 14)(1, \"button\", 15);\n    i0.ɵɵtext(2, \" Add a new Player \");\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(1, _c0));\n  }\n}\n\nfunction PlayerListComponent_th_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 16);\n    i0.ɵɵtext(1, \"ID\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PlayerListComponent_td_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const player_r12 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", player_r12.id, \" \");\n  }\n}\n\nfunction PlayerListComponent_th_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 16);\n    i0.ɵɵtext(1, \"First Name\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nconst _c1 = function (a1) {\n  return [\"/player\", a1];\n};\n\nfunction PlayerListComponent_td_14_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17)(1, \"a\", 18);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd()();\n  }\n\n  if (rf & 2) {\n    const player_r13 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction1(2, _c1, player_r13.id));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(player_r13.firstName);\n  }\n}\n\nfunction PlayerListComponent_th_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 16);\n    i0.ɵɵtext(1, \"Last Name\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PlayerListComponent_td_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const player_r14 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", player_r14.lastName, \" \");\n  }\n}\n\nfunction PlayerListComponent_th_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"th\", 16);\n    i0.ɵɵtext(1, \"Nation\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction PlayerListComponent_td_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"td\", 17);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const player_r15 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", player_r15.country.text, \" \");\n  }\n}\n\nfunction PlayerListComponent_tr_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 19);\n  }\n}\n\nfunction PlayerListComponent_tr_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"tr\", 20);\n  }\n}\n\nconst _c2 = function () {\n  return [10, 20, 50];\n};\n\nexport let PlayerListComponent = /*#__PURE__*/(() => {\n  class PlayerListComponent {\n    //#endregion\n    //#region Constructor\n    constructor(http, baseUrl, playerService) {\n      this.http = http;\n      this.baseUrl = baseUrl;\n      this.playerService = playerService;\n      this.displayedColumns = ['id', 'firstName', 'lastName', 'country'];\n      this.subscriptions = new Array();\n    } //#endregion\n    //#region Events\n\n\n    ngOnDestroy() {\n      if (this.subscriptions) {\n        this.subscriptions.forEach(subscription => subscription.unsubscribe);\n      }\n    }\n\n    ngOnInit() {\n      this.initialize();\n    }\n\n    onFilterTextChanged(filterText) {\n      if (this.filterTextChanged.observers.length === 0) {\n        this.subscriptions.push(this.filterTextChanged.pipe(debounceTime(1000), distinctUntilChanged()).subscribe(query => {\n          this.loadData(query);\n        }));\n      }\n\n      this.filterTextChanged.next(filterText);\n    } //#endregion\n    //#region Methods\n\n\n    getData(event) {\n      //let url = this.baseUrl + 'api/Players/TableData';\n      //let params = this.setParameters(event);\n      //if (this.filterQuery) {\n      //  params = params.set(\"filterColumn\", this.defaultFilterColumn)\n      //    .set(\"filterQuery\", this.filterQuery);\n      //}\n      let pageIndex = +event.pageIndex;\n      let pageSize = +event.pageSize;\n      let sortColumn = this.sort ? this.sort.active : this.defaultSortColumn;\n      let sortOrder = this.sort ? this.sort.direction : this.defaultSortOrder;\n      let filterColumn = this.defaultFilterColumn;\n      let filterQuery = this.filterQuery;\n      this.subscriptions.push(this.playerService.getTableData(pageIndex, pageSize, sortColumn, sortOrder, filterColumn, filterQuery).subscribe(tableData => {\n        this.paginator.length = tableData.totalCount;\n        this.paginator.pageIndex = tableData.pageIndex;\n        this.paginator.pageSize = tableData.pageSize;\n        this.players = new MatTableDataSource(tableData.data);\n      }, error => this.errorMessage = error)); //this.http.get<ITableData<IPlayer>>(url, { params }).subscribe(result => {\n      //  this.paginator.length = result.totalCount;\n      //  this.paginator.pageIndex = result.pageIndex;\n      //  this.paginator.pageSize = result.pageSize;\n      //  this.players = new MatTableDataSource(result.data);\n      //}, error => console.error(error));\n    }\n\n    initialize() {\n      this.defaultPageIndex = 0;\n      this.defaultPageSize = 10;\n      this.defaultSortColumn = \"id\";\n      this.defaultSortOrder = \"asc\";\n      this.defaultFilterColumn = \"lastName\";\n      this.filterQuery = null;\n      this.filterTextChanged = new Subject();\n      this.loadData(null);\n    }\n\n    loadData(query = null) {\n      var pageEvent = new PageEvent();\n      pageEvent.pageIndex = this.defaultPageIndex;\n      pageEvent.pageSize = this.defaultPageSize;\n\n      if (query) {\n        this.filterQuery = query;\n      }\n\n      this.getData(pageEvent);\n    }\n\n    setParameters(event) {\n      return new HttpParams().set(\"pageIndex\", event.pageIndex.toString()).set(\"pageSize\", event.pageSize.toString()).set(\"sortColumn\", this.sort ? this.sort.active : this.defaultSortColumn).set(\"sortOrder\", this.sort ? this.sort.direction : this.defaultSortOrder);\n    }\n\n  }\n\n  PlayerListComponent.ɵfac = function PlayerListComponent_Factory(t) {\n    return new (t || PlayerListComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject('BASE_URL'), i0.ɵɵdirectiveInject(i2.PlayerService));\n  };\n\n  PlayerListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: PlayerListComponent,\n    selectors: [[\"sm-player-list\"]],\n    viewQuery: function PlayerListComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(MatPaginator, 5);\n        i0.ɵɵviewQuery(MatSort, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.paginator = _t.first);\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.sort = _t.first);\n      }\n    },\n    decls: 24,\n    vars: 13,\n    consts: [[4, \"ngIf\"], [\"class\", \"commands text-right\", 4, \"ngIf\"], [3, \"hidden\"], [\"matInput\", \"\", \"placeholder\", \"Filter by name (or part of it)...\", 3, \"keyup\"], [\"mat-table\", \"\", \"matSort\", \"\", 1, \"table-striped\", \"mat-elevation-z8\", 3, \"dataSource\", \"hidden\", \"matSortActive\", \"matSortDirection\", \"matSortChange\"], [\"matColumnDef\", \"id\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\", 4, \"matHeaderCellDef\"], [\"mat-cell\", \"\", 4, \"matCellDef\"], [\"matColumnDef\", \"firstName\"], [\"matColumnDef\", \"lastName\"], [\"matColumnDef\", \"country\"], [\"mat-header-row\", \"\", 4, \"matHeaderRowDef\"], [\"mat-row\", \"\", 4, \"matRowDef\", \"matRowDefColumns\"], [\"showFirstLastButtons\", \"\", 3, \"hidden\", \"pageSize\", \"pageSizeOptions\", \"page\"], [1, \"commands\", \"text-right\"], [\"type\", \"submit\", 1, \"btn\", \"btn-success\", 3, \"routerLink\"], [\"mat-header-cell\", \"\", \"mat-sort-header\", \"\"], [\"mat-cell\", \"\"], [3, \"routerLink\"], [\"mat-header-row\", \"\"], [\"mat-row\", \"\"]],\n    template: function PlayerListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\");\n        i0.ɵɵtext(1, \"Players\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"p\");\n        i0.ɵɵtext(3, \"List of Players\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, PlayerListComponent_p_4_Template, 3, 0, \"p\", 0);\n        i0.ɵɵtemplate(5, PlayerListComponent_div_5_Template, 3, 2, \"div\", 1);\n        i0.ɵɵelementStart(6, \"mat-form-field\", 2)(7, \"input\", 3);\n        i0.ɵɵlistener(\"keyup\", function PlayerListComponent_Template_input_keyup_7_listener($event) {\n          return ctx.onFilterTextChanged($event.target.value);\n        });\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(8, \"table\", 4);\n        i0.ɵɵlistener(\"matSortChange\", function PlayerListComponent_Template_table_matSortChange_8_listener() {\n          return ctx.loadData();\n        });\n        i0.ɵɵelementContainerStart(9, 5);\n        i0.ɵɵtemplate(10, PlayerListComponent_th_10_Template, 2, 0, \"th\", 6);\n        i0.ɵɵtemplate(11, PlayerListComponent_td_11_Template, 2, 1, \"td\", 7);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(12, 8);\n        i0.ɵɵtemplate(13, PlayerListComponent_th_13_Template, 2, 0, \"th\", 6);\n        i0.ɵɵtemplate(14, PlayerListComponent_td_14_Template, 3, 4, \"td\", 7);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(15, 9);\n        i0.ɵɵtemplate(16, PlayerListComponent_th_16_Template, 2, 0, \"th\", 6);\n        i0.ɵɵtemplate(17, PlayerListComponent_td_17_Template, 2, 1, \"td\", 7);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵelementContainerStart(18, 10);\n        i0.ɵɵtemplate(19, PlayerListComponent_th_19_Template, 2, 0, \"th\", 6);\n        i0.ɵɵtemplate(20, PlayerListComponent_td_20_Template, 2, 1, \"td\", 7);\n        i0.ɵɵelementContainerEnd();\n        i0.ɵɵtemplate(21, PlayerListComponent_tr_21_Template, 1, 0, \"tr\", 11);\n        i0.ɵɵtemplate(22, PlayerListComponent_tr_22_Template, 1, 0, \"tr\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"mat-paginator\", 13);\n        i0.ɵɵlistener(\"page\", function PlayerListComponent_Template_mat_paginator_page_23_listener($event) {\n          return ctx.getData($event);\n        });\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", !ctx.players);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.players);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", !ctx.players);\n        i0.ɵɵadvance(2);\n        i0.ɵɵpropertyInterpolate(\"matSortActive\", ctx.defaultSortColumn);\n        i0.ɵɵpropertyInterpolate(\"matSortDirection\", ctx.defaultSortOrder);\n        i0.ɵɵproperty(\"dataSource\", ctx.players)(\"hidden\", !ctx.players);\n        i0.ɵɵadvance(13);\n        i0.ɵɵproperty(\"matHeaderRowDef\", ctx.displayedColumns);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"matRowDefColumns\", ctx.displayedColumns);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"hidden\", !ctx.players)(\"pageSize\", 10)(\"pageSizeOptions\", i0.ɵɵpureFunction0(12, _c2));\n      }\n    },\n    directives: [i3.NgIf, i4.RouterLink, i5.MatFormField, i6.MatInput, i7.MatTable, i8.MatSort, i7.MatColumnDef, i7.MatHeaderCellDef, i7.MatHeaderCell, i8.MatSortHeader, i7.MatCellDef, i7.MatCell, i4.RouterLinkWithHref, i7.MatHeaderRowDef, i7.MatHeaderRow, i7.MatRowDef, i7.MatRow, i9.MatPaginator],\n    styles: [\"table[_ngcontent-%COMP%]{width:100%}.mat-form-field[_ngcontent-%COMP%]{font-size:14px;width:100%}\"]\n  });\n  return PlayerListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}