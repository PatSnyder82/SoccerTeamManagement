{"ast":null,"code":"import { FormBuilder, Validators } from '@angular/forms';\nimport { MatDialogRef, MAT_DIALOG_DATA } from '@angular/material/dialog';\nimport { ClubService } from '../../../../services/club.service';\nimport { LeagueService } from '../../../../services/league.service';\nimport { TeamService } from '../../../../services/team.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/material/dialog\";\nimport * as i3 from \"../../../../services/club.service\";\nimport * as i4 from \"../../../../services/league.service\";\nimport * as i5 from \"../../../../services/team.service\";\n\nfunction TeamSelectModalComponent_mat_option_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const league_r6 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", league_r6.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", league_r6.text, \" \");\n  }\n}\n\nfunction TeamSelectModalComponent_mat_error_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Input required\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction TeamSelectModalComponent_section_12_mat_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const club_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", club_r9.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", club_r9.text, \" \");\n  }\n}\n\nfunction TeamSelectModalComponent_section_12_mat_error_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Input required\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction TeamSelectModalComponent_section_12_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"section\", 4)(1, \"mat-label\");\n    i0.ɵɵtext(2, \"Club:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"mat-select\", 19);\n    i0.ɵɵlistener(\"selectionChange\", function TeamSelectModalComponent_section_12_Template_mat_select_selectionChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.onClubChange($event.value);\n    });\n    i0.ɵɵtemplate(4, TeamSelectModalComponent_section_12_mat_option_4_Template, 2, 2, \"mat-option\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, TeamSelectModalComponent_section_12_mat_error_5_Template, 3, 0, \"mat-error\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.clubs);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.controls.clubId.hasError(\"required\"));\n  }\n}\n\nfunction TeamSelectModalComponent_section_14_mat_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 18);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const team_r14 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", team_r14.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", team_r14.text, \" \");\n  }\n}\n\nfunction TeamSelectModalComponent_section_14_mat_error_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Input required\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nfunction TeamSelectModalComponent_section_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"section\", 4)(1, \"mat-label\");\n    i0.ɵɵtext(2, \"Team:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"mat-select\", 20);\n    i0.ɵɵlistener(\"selectionChange\", function TeamSelectModalComponent_section_14_Template_mat_select_selectionChange_3_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.onTeamChange($event.value);\n    });\n    i0.ɵɵtemplate(4, TeamSelectModalComponent_section_14_mat_option_4_Template, 2, 2, \"mat-option\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, TeamSelectModalComponent_section_14_mat_error_5_Template, 3, 0, \"mat-error\", 7);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.teams);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.controls.teamId.hasError(\"required\"));\n  }\n}\n\nfunction TeamSelectModalComponent_mat_error_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-error\")(1, \"strong\");\n    i0.ɵɵtext(2, \"Input required\");\n    i0.ɵɵelementEnd()();\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"hidden\": a0\n  };\n};\n\nexport let TeamSelectModalComponent = /*#__PURE__*/(() => {\n  class TeamSelectModalComponent {\n    //#endregion\n    //#region Constructor\n    constructor(formBuilder, dialogRef, playerId, clubService, leagueService, teamService) {\n      this.formBuilder = formBuilder;\n      this.dialogRef = dialogRef;\n      this.playerId = playerId;\n      this.clubService = clubService;\n      this.leagueService = leagueService;\n      this.teamService = teamService;\n      this.errorMessage = '';\n      this.clubs = [];\n      this.leagues = [];\n      this.selectedTeam = {};\n      this.subscriptions = [];\n      this.teams = [];\n    } //#endregion\n    //#region Events\n\n\n    ngOnDestroy() {\n      if (this.subscriptions) {\n        this.subscriptions.forEach(subscription => subscription.unsubscribe);\n      }\n    }\n\n    ngOnInit() {\n      this.form = this._initializeFormGroup();\n      this.controls = this._initializeControlReferences();\n      this.controls.clubId.disable();\n      this.controls.teamId.disable();\n\n      this._getLeagues();\n\n      this._conditionalValidationOfClubs();\n\n      this._conditionalValidationOfTeams();\n    }\n\n    onClose() {\n      this.dialogRef.close();\n    }\n\n    onClubChange(clubId) {\n      this._getTeams(clubId);\n    }\n\n    onLeagueChange(leagueId) {\n      this._getClubs(leagueId);\n\n      this.controls.teamId.disable();\n    }\n\n    onSubmit() {\n      var _a;\n\n      if ((_a = this.form) === null || _a === void 0 ? void 0 : _a.valid) {\n        const joinedTeam = this.controls.joinedTeam.value;\n        const playerTeam = this.teamService.toTeamPlayer(this.selectedTeam.id, this.playerId, joinedTeam, null);\n        this.dialogRef.close({\n          data: playerTeam\n        });\n      } else {\n        this.form.markAllAsTouched();\n      }\n    }\n\n    onTeamChange(teamId) {\n      const selectedTeam = this.teams.find(x => x.id === teamId);\n\n      if (selectedTeam) {\n        this.selectedTeam = selectedTeam;\n      } else {\n        this.selectedTeam = null;\n      }\n    } //#endregion\n    //#region Methods\n\n\n    _conditionalValidationOfClubs() {\n      this.subscriptions.push(this.controls.leagueId.valueChanges.subscribe(() => {\n        if (this.controls.clubId.disabled) {\n          this.controls.clubId.clearValidators();\n        } else {\n          this.controls.clubId.setValidators([Validators.required]);\n        }\n\n        this.controls.clubId.updateValueAndValidity();\n      }));\n    }\n\n    _conditionalValidationOfTeams() {\n      this.subscriptions.push(this.controls.clubId.valueChanges.subscribe(() => {\n        if (this.controls.teamId.disabled) {\n          this.controls.teamId.clearValidators();\n        } else {\n          this.controls.teamId.setValidators([Validators.required]);\n        }\n\n        this.controls.teamId.updateValueAndValidity();\n      }));\n    }\n\n    _initializeControlReferences() {\n      return {\n        leagueId: this.form.get('leagueId'),\n        clubId: this.form.get('clubId'),\n        joinedTeam: this.form.get('joinedTeam'),\n        teamId: this.form.get('teamId')\n      };\n    }\n\n    _initializeFormGroup() {\n      return this.formBuilder.group({\n        leagueId: [null, [Validators.required]],\n        clubId: [null],\n        joinedTeam: [Date.now(), [Validators.required]],\n        teamId: [null]\n      });\n    }\n\n    _getLeagues() {\n      if (!this.leagues) {\n        this.subscriptions.push(this.leagueService.getAll().subscribe(data => this.leagues = data, error => this.errorMessage = error));\n      }\n    }\n\n    _getClubs(leagueId) {\n      this.subscriptions.push(this.clubService.getByLeague(leagueId).subscribe(data => this.clubs = data, error => this.errorMessage = error, () => this.controls.clubId.enable()));\n    }\n\n    _getTeams(clubId) {\n      this.subscriptions.push(this.teamService.getByClub(clubId).subscribe(data => this.teams = data, error => this.errorMessage = error, () => this.controls.teamId.enable()));\n    }\n\n  }\n\n  TeamSelectModalComponent.ɵfac = function TeamSelectModalComponent_Factory(t) {\n    return new (t || TeamSelectModalComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.MatDialogRef), i0.ɵɵdirectiveInject(MAT_DIALOG_DATA), i0.ɵɵdirectiveInject(i3.ClubService), i0.ɵɵdirectiveInject(i4.LeagueService), i0.ɵɵdirectiveInject(i5.TeamService));\n  };\n\n  TeamSelectModalComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: TeamSelectModalComponent,\n    selectors: [[\"sm-team-select-modal\"]],\n    decls: 32,\n    vars: 12,\n    consts: [[\"mat-dialog-title\", \"\"], [1, \"team-select-modal\", 3, \"formGroup\", \"ngSubmit\"], [\"mat-dialog-content\", \"\"], [1, \"row\"], [1, \"form-group\"], [\"formControlName\", \"leagueId\", 1, \"form-control\", 3, \"ngClass\", \"selectionChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [\"class\", \"form-group\", 4, \"ngIf\"], [1, \"col-10\"], [\"matInput\", \"\", \"formControlName\", \"joinedTeam\", 1, \"form-control\", \"col-5\"], [1, \"col-2\"], [3, \"for\"], [\"picker\", \"\"], [\"mat-dialog-actions\", \"\"], [1, \"form-group\", \"commands\"], [\"mat-raised-button\", \"\", \"type\", \"submit\", \"value\", \"Submit\", \"color\", \"warn\", 3, \"disabled\"], [\"mat-raised-button\", \"\", \"type\", \"button\", 3, \"click\"], [3, \"value\"], [\"formControlName\", \"clubId\", 1, \"form-control\", 3, \"selectionChange\"], [\"formControlName\", \"teamId\", 1, \"form-control\", 3, \"selectionChange\"]],\n    template: function TeamSelectModalComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h1\", 0);\n        i0.ɵɵtext(1);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function TeamSelectModalComponent_Template_form_ngSubmit_2_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(3, \"div\", 2)(4, \"div\", 3)(5, \"section\", 4)(6, \"mat-label\");\n        i0.ɵɵtext(7, \"League:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"mat-select\", 5);\n        i0.ɵɵlistener(\"selectionChange\", function TeamSelectModalComponent_Template_mat_select_selectionChange_8_listener($event) {\n          return ctx.onLeagueChange($event.value);\n        });\n        i0.ɵɵtemplate(9, TeamSelectModalComponent_mat_option_9_Template, 2, 2, \"mat-option\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, TeamSelectModalComponent_mat_error_10_Template, 3, 0, \"mat-error\", 7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(11, \"div\", 3);\n        i0.ɵɵtemplate(12, TeamSelectModalComponent_section_12_Template, 6, 2, \"section\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 3);\n        i0.ɵɵtemplate(14, TeamSelectModalComponent_section_14_Template, 6, 2, \"section\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 3)(16, \"mat-label\");\n        i0.ɵɵtext(17, \"Joined Team:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(18, \"br\");\n        i0.ɵɵelementStart(19, \"div\", 9);\n        i0.ɵɵelement(20, \"input\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"div\", 11);\n        i0.ɵɵelement(22, \"mat-datepicker-toggle\", 12)(23, \"mat-datepicker\", null, 13);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(25, TeamSelectModalComponent_mat_error_25_Template, 3, 0, \"mat-error\", 7);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(26, \"div\", 14)(27, \"section\", 15)(28, \"button\", 16);\n        i0.ɵɵtext(29, \"Update\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"button\", 17);\n        i0.ɵɵlistener(\"click\", function TeamSelectModalComponent_Template_button_click_30_listener() {\n          return ctx.onClose();\n        });\n        i0.ɵɵtext(31, \"Close\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        const _r4 = i0.ɵɵreference(24);\n\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.title);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.form);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction1(10, _c0, ctx.controls.leagueId.disabled));\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.leagues);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.controls.leagueId.hasError(\"required\") && (ctx.controls.leagueId.dirty || ctx.controls.leagueId.touched));\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.controls.leagueId.value != null);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.controls.clubId.value != null);\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"for\", _r4);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngIf\", ctx.controls.joinedTeam.hasError(\"required\") && (ctx.controls.joinedTeam.dirty || ctx.controls.joinedTeam.touched));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.form.invalid);\n      }\n    },\n    styles: [\".hidden[_ngcontent-%COMP%]{display:none}\"]\n  });\n  return TeamSelectModalComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}